<Window x:Class="PomodoroForObsidian.MiniWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        Width="340" Height="36"
        MinWidth="220" MinHeight="36" MaxHeight="36"
        WindowStartupLocation="Manual"
        Title="Mini Pomodoro">
    <Window.Resources>
        <!-- Style for square buttons -->
        <Style x:Key="SquareButtonStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Style for square textbox -->
        <Style x:Key="SquareTextBoxStyle" TargetType="TextBox">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                          Focusable="False" 
                                          HorizontalScrollBarVisibility="Hidden" 
                                          VerticalScrollBarVisibility="Hidden"
                                          Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Border CornerRadius="0" Background="#1a1523" BorderBrush="#a06fc6" BorderThickness="2" Padding="0" MouseLeftButtonDown="Border_MouseLeftButtonDown">
            <Grid Margin="4,0,4,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox x:Name="MiniTaskInput" Grid.Column="0" Height="22" Margin="4,0,4,0" 
                         VerticalContentAlignment="Center" FontSize="11" 
                         Background="#2d223a" Foreground="White" 
                         BorderBrush="#a06fc6" BorderThickness="1" 
                         Padding="4,0" 
                         MinWidth="60" 
                         TextChanged="MiniTaskInput_TextChanged"
                         PreviewKeyDown="MiniTaskInput_PreviewKeyDown"
                         Style="{StaticResource SquareTextBoxStyle}" />
                <TextBlock x:Name="MiniTimerText" Grid.Column="1" Text="25:00" 
                           Foreground="White" FontSize="14" FontWeight="Bold" 
                           VerticalAlignment="Center" HorizontalAlignment="Center" 
                           TextAlignment="Center"
                           Width="65" Height="22" Margin="4,0,2,0" 
                           PreviewMouseDown="MiniTimerText_PreviewMouseDown" 
                           Cursor="Hand" />
                <Button x:Name="MiniStartStopButton" Grid.Column="2" Content="â–¶" 
                        Width="22" Height="22" 
                        Background="#d18be9" Foreground="White" 
                        FontSize="13" FontWeight="Bold" 
                        BorderBrush="#d18be9" BorderThickness="0" 
                        Cursor="Hand" VerticalAlignment="Center" 
                        Margin="4,0,4,0" 
                        Style="{StaticResource SquareButtonStyle}" />
            </Grid>
                </Border>
        
                <Popup x:Name="AutoCompletePopup" IsOpen="False" StaysOpen="False" PlacementTarget="{Binding ElementName=MiniTaskInput}" Placement="Bottom">
                    <ListBox x:Name="AutoCompleteListBox" Focusable="False" KeyDown="AutoCompleteListBox_KeyDown" MouseDoubleClick="AutoCompleteListBox_MouseDoubleClick" Background="#2d223a" Foreground="White" BorderBrush="#a06fc6" BorderThickness="1">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Background" Value="#2d223a"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#a06fc6"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>
                </Popup>
        
                <!-- Edge resize handles (horizontal only) -->
        <Border x:Name="ResizeHandleLeft" Width="6" HorizontalAlignment="Left" VerticalAlignment="Stretch" Background="Transparent" Cursor="SizeWE" MouseDown="ResizeLeft_MouseDown" />
        <Border x:Name="ResizeHandleRight" Width="6" HorizontalAlignment="Right" VerticalAlignment="Stretch" Background="Transparent" Cursor="SizeWE" MouseDown="ResizeRight_MouseDown" />
    </Grid>
</Window>
